(function(a,b){define(["backbone","underscore","IO/IO","Device/Device"],function(a,b,c,d){var e=a.Collection.extend({url:"wdj://apps/show.json",data:{upgrade_info:1},parse:function(a){a.state_code===202&&d.get("isConnected")&&(this.syncing=!0,this.trigger("syncStart")),this.loadingUpdateInfo=a.state_code===251||a.state_code===202;var c=b.map(a.body.app,function(a){return{id:a.base_info.package_name,packageName:a.base_info.package_name,versionCode:a.base_info.version_code}});return c},initialize:function(){var a=!1,b=!1,d=!1;Object.defineProperties(this,{loading:{set:function(b){a=b},get:function(){return a}},loadingUpdateInfo:{set:function(a){b=a},get:function(){return b}},syncing:{set:function(a){d=a},get:function(){return d}}}),this.on("update",function(){a||(a=!0,this.fetch({success:function(b){a=!1,b.trigger("refresh",b)}}))},this),c.Backend.onmessage({"data.channel":"apps.updated"},function(b){d&&(d=!1,this.trigger("syncEnd")),b?this.trigger("update"):a=!1},this)}}),f,g=b.extend({getInstance:function(){return f||(f=new e,f.trigger("update")),f}});return g})})(this)