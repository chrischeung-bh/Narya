(function(a,b){define(["IO/IO"],function(a){var b={};return b.openExtensionAsync=function(b,c,d){var e=$.Deferred();return a.requestAsync({url:"wdj://window/publish.json",data:{channel:"sidebar.preview",value:JSON.stringify({id:b,name:c,targetURL:d})},success:function(a){a.state_code===200?e.resolve(a):e.reject(a)}}),e.promise()},b.downloadAsync=function(b,c,d,e,f){var g=$.Deferred(),h;switch(b){case"app":h="wdj://apps/download.json";break;case"app-data":h="wdj://apps_data/download.json";break;case"music":h="wdj://music/download.json";break;case"photo":h="wdj://photo/download.json";break;case"video":h="wdj://video/download.json";break;case"book":h="wdj://book/download.json";break;default:h="wdj://apps/download.json"}return a.requestAsync({url:h,data:{url:c,name:d,icon:e,source:"SnapPea SDK",format:f||""},success:function(a){a.state_code===200?g.resolve(a):g.reject(a)}}),g.promise()},b})})(this)