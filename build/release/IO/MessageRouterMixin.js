(function(a,b){define(["underscore","backbone","utils/FilterFunction"],function(c,d,e){console.log("MessageRouterMixin - File loaded.");var f=1,g=c.extend(function(){},d.Events),h=function(b,c,d){return f++,this.callbackList.push({id:f,route:b,filter:e.generate(b),callback:c,context:d||a}),f},i=function(a){var c=this.callbackList,d=e.generate({id:a}),f;for(f=c.length;f--;b)if(d(c[f])){c.splice(f,1);break}},j=function(a){c.each(this.callbackList,function(b){b.filter(a)&&b.callback.call(b.context,JSON.parse(a.data.data))})};return g.mixin=function(a){a.onmessage=h.bind(a),a.offmessage=i.bind(a),a.on("message",j.bind(a)),a.callbackList=[]},g})})(this)